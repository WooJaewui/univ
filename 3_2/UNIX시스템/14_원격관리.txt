
 원격관리.



 # 전통적인 방법.

전통적 원격 접속 방법.
telnet, rlogin, rsh, ftp, rcp 등.
전통적 방법들은 암호화가 되지 않은 데이터를 주고 받음. ( 도청이나 위변조 등 보안에 취약함 )
현재 거의 쓰이지 않음.

telnet 명령.
원격의 컴퓨터에 telnet 프로토콜로 접속하는 프로그램.
사용자 계정과 비밀번호를 이용하여 원격으로 로그인 함.

telnet [-l user] host 또는 telnet user@host.
-l 옵션을 생략하는 경우 호스트로부터 사용자 계정을 요구 받음.
-l 옵션 대신에 @을 이용하여 사용자 계정을 제시할 수도 있음.
사용이 끝나면 logout 또는 exit을 이용하여 로그아웃 함.

ftp 명령. ( file transfer protocal )
원격에서 터미널로 접속하여 파일을 업/다운로드 할 수 있는 파일 전송 프로토콜 또는 프로그램.

rcp 명령.
원격의 컴퓨터와 서로 파일을 복사하는 프로그램. ( cp명령과 유사함 )

rcp [-r] source_file target_file.
source_file을 target_file로 복사함.
target_file이 디렉토리라면 해당 디렉토리에 source_file을 복사함.
-r 옵션을 사용하면 source_file이 디렉토리이며, 서브디렉토리도 함께 target_file 디렉토리로 복사함.
원격 파일의 경우 [user@]host[:remote_file]의 형태.
rcp는 ftp와 달리 일회성으로 파일을 전송.
예 : rcp sample.txt sooyo12@123.456.0.34 ;



 # SSH Secure Shell.

원격 관리를 위한 전통적인 방법( telnet, ftp, rcp 등 )의 문제.
서버와 클라이언트 간 연결을 통해 주고받는 모든 명령과 결과 및 계정 정보 등이 암호화되지 않음.

SSH.
SSH는 원격 로그인이나 원격 데이터 통신에 사용되는 프로토콜로 패킷을 암호화하여 전송.
전통적인 원격 관리 방법들의 문제점을 해결.
서버/클라이언트 구조로 동작하며, TCP 포트 번호 22를 사용하여 서로 통신함.
보안을 위해 전자서명을 이용하여 서버와 클라이언트 간 연결을 인증하고, 메시지를 암호화함.

SSH를 사용하기 위해 필요한 프로그램.
서버 : sshd가 데몬 형태의 프로세스로 동작 중이어야 함.
클라이언트 : 사용 목적에 따라 ssh, sftp, scp 등이 필요함.

OpenSSH 패키지.
SSH 프로토콜을 사용하는 패키지로 공개 소스 프로그램.
암호화된 안전한 통신을 제공하는 네트워크 연결 도구의 집합.
서버 프로그램은 sshd, 클라이언트 프로그램 scp, sftp, ssh 등을 포함.
현재 대부분의 리눅스 배포판에 OpenSSH가 포함되어 있음.
전역 설정 파일은 /etc/ssh/ 디렉토리에 저장됨.
개별 사용자의 설정 파일은 ~/.ssh/ 디렉토리에 저장됨.

OpenSSH 설치 및 확인.
yum list installed | grep openssh : 설치 확인.
yum -y install openssh openssh-server : 서버 설치.
yum -y install openssh-clients : 클라이언트 설치.
yum -y update openssh : 업데이트 방법.

SSH 서버의 실행.
SSH를 이용하기 위해서는 sshd 데몬이 실행 중어이어야 함.
부팅 시 자동으로 데몬을 시작시킬 수 있음.

SSH 실행 방법.
service sshd start : 실행.
service sshd stop : 중지.
service sshd status : 상태 확인.
chkconfig --list sshd : 런레벨 별 서비스의 활성화 여부 확인.
chkconfig sshd on : 부팅 시 자동 실행.

서비스 설정 도구.
데스크탑 메뉴 -> 시스템 -> 관리 -> 서비스.
서비스 설정 창을 연 후 sshd를 찾아서 활성화 및 실행 상태를 확인하고 변경할 수 있음.

방화벽 설정1.
방화벽을 사용 중이라면, 설정을 확인한 후 사용하려는 서비스. 해당 포트와 프토로콜을 열어야함.
원격의 사용자가 어떤 서비스를 사용할 수 있는지를 제어할 수 있음.
방화벽 설정 파일은 etc/sysconfig/iptables

방화벽 설정2.
데스크탑 메뉴 -> 시스템 -> 관리 -> 방화벽.
방화벽 설정 창에서 신뢰하는 서비스를 선택한 후, 해당 서비스를 체크하고 적용함.
비활성화는 방화벽을 사용하지 않겠다는 것임.
설정을 바꾸면 iptables의 내용이 변경됨.

가상 머신의 SSH 서버에 접속하기.
호스트 PC 또는 외부에서 가상 머신에 설치된 sshd 또는 httpd에 접속하기.
호스트 PC는 네트워크 인터페이스를 가지고 있음.
가상 머신은 별도의 가상 네트워크 인터페이스를 가짐.
가상 머신의 IP 주소는 기본적으로 10.0.2.15로 할당됨.

접속 방법.
가상 머신의 리눅스에서 방화벽 설정을 확인.
가상 머신의 리눅스에서 서버 프로세스의 실행 여부를 확인.

포트 포워딩 설정.
호스트 PC의 IP 주소와 포트 번호로 접속할 때, 가상 머신의 IP주소와 포트 번호를 연결.

VirtualBox에서 포트 포워딩 설정 방법.
가상 머신을 선택하고 VirtualBox 메뉴에서 설정을 선택.
설정 창 -> 네트워크 -> 어댑터1 -> 고급 -> 포트포워딩 선택 -> 포트 포워딩 규칙
-> [+]를 선택한 후 규칙을 추가함.
호스트 PC에서는 서버를 운영하지 않는 것을 가정하여 설명함.
호스트 PC에서 서버를 운영하면 포트번호를 바꿔서 설정해줘야 함.

포트 포워딩 설정 예시.
SSH : 127.0.0.1:22 -> 가상머신 ip:22 
HTTP : 127.0.0.1:80 -> 가상머신 ip:80

원격 접속 ssh.
ssh는 SSH 서버에 원격으로 접속하기 위한 클라이언트 프로그램.
사용자 계정과 비밀번호를 이용하여 로그인하고, 이후에는 컴퓨터에 직접 로그인한 것과 동일.
telnet, rlogin, rsh 등을 대체.

ssh [-l user] host 또는 ssh user@host.
ssh에서 telnet과 같이 리눅스 명령어의 사용이 가능함.
exit 또는 logout 명령으로 로그아웃.
예 : ssh -l kdhong 192.168.0.37과 같이 실행함.

원격 ssh 원리.
클라이언트 컴퓨터에서는 ~/.ssh/known_hosts 파일에 원격으로 접속했던 호스트의 공개키를 저장함.
윈도우에서는 공개 소프트웨어인 PuTTY 또는 Xshell을 클라이언트 프로그램으로 이용하여 접속할 수 있음.
( 암호화 된 telnet을 사용가능하게 해줌 )

원격 파일 전송 sftp.
sftp는 서버에 원격 접속하여 파일을 업로드하거나 다운로드할 수 있는 클라이언트 프로그램.
암호화된 연결을 제외하면 사용 방법은 ftp와 같음.

sftp [user@] host.
원격 호스트 접속에 성공하면 지정된 사용자의 계정으로 호스트를 이용할 수 있음.
예 : sftp sooyo12@192.168.0.12

sftp 프롬프트 명령.
help : sftp에서 사용할 수 있는 명령의 사용법을 조회.
ls : 원격 작업 디렉토리의 내용을 보여줌.
cd path : 원격 작업 디렉토리를 변경.
mkdir path : 원격 디렉토리를 생성.
chmod mode path : 파일 path에 대한 권한을 mode로 변경.
get : 파일을 원격 서버에서 로컬 클라이언트로 받음.
put : 파일을 로컬 클라이언트에서 원격 서버로 보냄.
mget : 여러 파일을 원격 서버로부터 로컬 클라이언트로 받음.
mput : 여러 파일을 로컬 클라이언트에서 원격 서버로 보냄.
bye 또는 exit 또는 quit : sftp를 종료.

원격 파일 복사 scp.
scp는 원격의 컴퓨터와 서로 파일을 복사하는 프로그램.

scp [-r] source file target file.
소스 파일이 원격에 존재하는 경우, 다음과 같이 표시함. [user@]host[:remote_file]
sftp로도 scp 기능을 수행할 수 있음. ( 대화식이 아닌 일회성으로 파일을 전송하는 것이 가능 )




